{"is_source_file": true, "format": "Python", "description": "This is a FastAPI-based backend API implementation for a Jira-Confluence integration platform. The file defines endpoints for health checks, user management, OAuth flows with Atlassian products, and integration connect/disconnect operations. It also includes middleware, structured logging, external dependencies, configuration helpers, and route handlers supporting OAuth callbacks, token exchanges, and connector management.", "external_files": ["src/db/config", "src/db/service", "src/api/oauth_config", "src/api/schemas", "src/connectors/jira/impl", "src/api/routers/connectors"], "external_methods": ["create_user", "list_users", "get_user_by_id", "get_user_by_email", "upsert_jira_project", "list_jira_projects_for_user", "upsert_confluence_page", "list_confluence_pages_for_user", "get_jira_oauth_config", "get_confluence_oauth_config", "get_frontend_base_url_default", "build_atlassian_authorize_url", "choose_jira_redirect_with_request", "get_atlassian_base_url", "get_env_bootstrap_debug", "get_active_redirect_uris_debug", "get_jira_oauth_env_debug"], "published": ["health_check", "healthz", "health_redirect_uri", "health_authorize_url_probe", "health_redirect_pieces", "confluence_login", "confluence_callback", "jira_login", "jira_callback", "create_user_endpoint", "list_users_endpoint", "get_user_endpoint", "connect_jira", "connect_confluence", "fetch_jira_projects", "fetch_confluence_pages", "upsert_jira_project_endpoint", "list_jira_projects_endpoint", "upsert_confluence_page_endpoint", "list_confluence_pages_endpoint", "jira_login_api_alias", "jira_callback_api_alias", "confluence_login_api_alias", "confluence_callback_api_alias", "atlassian_callback_alias"], "classes": [{"name": "SafeJSONFormatter", "description": "Custom JSON formatter for structured logs with secret redaction."}, {"name": "RequestIDMiddleware", "description": "Middleware to assign and propagate unique request IDs for tracing."}], "methods": [{"name": "str _sign_state(value: str)", "description": "Creates an HMAC-SHA256 signed string of the given value.", "scope": "", "scopeKind": ""}, {"name": "bool _verify_signed_state(signed: str)", "description": "Verifies the integrity and authenticity of a signed state string.", "scope": "", "scopeKind": ""}, {"name": "str _gen_csrf_state()", "description": "Generates a URL-safe random token for CSRF protection.", "scope": "", "scopeKind": ""}, {"name": "str _redact_value(_: Any)", "description": "Redacts sensitive values for logging.", "scope": "", "scopeKind": ""}, {"name": "bool _should_redact(key: str)", "description": "Determines if a key indicates sensitive data needing redaction.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _redact_mapping(mapping: Dict[str, Any])", "description": "Returns a redacted copy of a dictionary for safe logging.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] _get_headers_subset(request: Request)", "description": "Extracts non-sensitive headers for observability.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _sanitized_query_params(request: Request)", "description": "Returns redacted query parameters.", "scope": "", "scopeKind": ""}, {"name": "None _log_event( level: int, event: str, request: Request, provider: Optional[str] = None, status_code: Optional[int] = None, **fields: Any, )", "description": "Logs structured event data with request context.", "scope": "", "scopeKind": ""}, {"name": "health_check()", "description": "Health check endpoint indicating service is up.", "scope": "", "scopeKind": ""}, {"name": "healthz()", "description": "Readiness probe endpoint.", "scope": "", "scopeKind": ""}, {"name": "health_redirect_uri()", "description": "Returns active redirect URIs for OAuth flows.", "scope": "", "scopeKind": ""}, {"name": "health_authorize_url_probe(request: Request)", "description": "Builds and returns the Jira OAuth authorization URL for verification.", "scope": "", "scopeKind": ""}, {"name": "health_redirect_pieces(request: Request)", "description": "Computes and returns URL components used in redirect URI formation.", "scope": "", "scopeKind": ""}, {"name": "jira_login_options()", "description": "CORS preflight handler for Jira login.", "scope": "", "scopeKind": ""}, {"name": "jira_login( request: Request, state: Optional[str] = None, scope: Optional[str] = None, redirect: Optional[bool] = False, )", "description": "Starts Jira OAuth 2.0 authorization flow, may redirect or return URL as JSON.", "scope": "", "scopeKind": ""}, {"name": "jira_callback( request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None, )", "description": "Handles OAuth callback, exchanges code for tokens, and redirects to frontend.", "scope": "", "scopeKind": ""}, {"name": "create_user_endpoint(payload: UserCreate, db=Depends(get_db))", "description": "Creates a new user or fetches existing by email.", "scope": "", "scopeKind": ""}, {"name": "list_users_endpoint(db=Depends(get_db))", "description": "Lists all users (public).", "scope": "", "scopeKind": ""}, {"name": "get_user_endpoint(user_id: int, db=Depends(get_db))", "description": "Fetches a user by internal ID.", "scope": "", "scopeKind": ""}, {"name": "confluence_login(request: Request, state: Optional[str] = None, scope: Optional[str] = None)", "description": "Starts Confluence OAuth 2.0 authorization.", "scope": "", "scopeKind": ""}, {"name": "confluence_callback(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)", "description": "Completes Confluence OAuth flow, storing tokens and redirecting.", "scope": "", "scopeKind": ""}, {"name": "fetch_jira_projects(db=Depends(get_db), owner_id: int | None = None)", "description": "Placeholder to fetch stored JIRA projects.", "scope": "", "scopeKind": ""}, {"name": "fetch_confluence_pages(db=Depends(get_db), owner_id: int | None = None)", "description": "Placeholder to fetch stored Confluence pages.", "scope": "", "scopeKind": ""}, {"name": "upsert_jira_project_endpoint(payload: JiraProjectCreate, db=Depends(get_db))", "description": "Creates or updates a JIRA project record.", "scope": "", "scopeKind": ""}, {"name": "list_jira_projects_endpoint(owner_id: int, db=Depends(get_db))", "description": "Lists projects for a user.", "scope": "", "scopeKind": ""}, {"name": "upsert_confluence_page_endpoint(payload: ConfluencePageCreate, db=Depends(get_db))", "description": "Creates or updates a Confluence page record.", "scope": "", "scopeKind": ""}, {"name": "list_confluence_pages_endpoint(owner_id: int, db=Depends(get_db))", "description": "Lists pages for a user.", "scope": "", "scopeKind": ""}, {"name": "connect_jira(db=Depends(get_db), payload: UserCreate | None = None)", "description": "Provides guidance to start Jira OAuth connect process.", "scope": "", "scopeKind": ""}, {"name": "connect_confluence(db=Depends(get_db), payload: UserCreate | None = None)", "description": "Provides guidance to start Confluence OAuth connect process.", "scope": "", "scopeKind": ""}, {"name": "atlassian_callback_alias(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)", "description": "Generic callback alias for Atlassian OAuth redirects.", "scope": "", "scopeKind": ""}, {"name": "logging.Logger _configure_logging()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_ensure_target_user(db, request: Request, state: Optional[str])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _ocean_response(data: Any, message: str = \"ok\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _parse_state_map(state: Optional[str])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_resolve_user_from_state(db, state: Optional[str])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "confluence_callback_api_alias(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "confluence_login_api_alias(request: Request, state: Optional[str] = None, scope: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dispatch(self, request: Request, call_next)", "scope": "RequestIDMiddleware", "scopeKind": "class", "description": "unavailable"}, {"name": "str format(self, record: logging.LogRecord)", "scope": "SafeJSONFormatter", "scopeKind": "class", "description": "unavailable"}, {"name": "global_exception_handler(request: Request, exc: Exception)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "jira_callback_api_alias(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "jira_login_api_alias( request: Request, state: Optional[str] = None, scope: Optional[str] = None, redirect: Optional[bool] = False, )", "scope": "", "scopeKind": "", "description": "unavailable"}], "search-terms": ["FastAPI", "OAuth", "JIRA", "Confluence", "OAuth callback", "Structured logging", "Request middleware", "Connect endpoints", "OAuth flow", "Token exchange", "Redirect URL", "OAuth authorization URL", "Permissions", "User management", "API health", "External dependencies"], "state": 2, "file_id": 1, "knowledge_revision": 272, "git_revision": "a5eaaf2193af96eed3584f9213569faeaa76a61e", "revision_history": [{"7": "3ddbecfdaea73dec9c7dc9e5f607ebdc11919216"}, {"18": "3ddbecfdaea73dec9c7dc9e5f607ebdc11919216"}, {"22": "5e41eb50619ad398f0acd99dcd0f280e619e1f8c"}, {"24": "5e41eb50619ad398f0acd99dcd0f280e619e1f8c"}, {"30": "28dac5a32d269d73eee9c3668810d8ab5eec8ee9"}, {"31": "7fbfd021c4802e87c6da87c524fde505c2578f38"}, {"32": "7fbfd021c4802e87c6da87c524fde505c2578f38"}, {"41": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"42": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"43": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"44": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"47": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"48": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"53": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"56": "8c69d0e627c970866f887e455b3fe92fd2ca45e7"}, {"58": "ce9dd25068e5bd76fdddef3c3666432880c7a53d"}, {"244": "40045ec0fea23c9f2aa4e9eb4f436d8d468723b7"}, {"248": "40045ec0fea23c9f2aa4e9eb4f436d8d468723b7"}, {"249": "e83268a392e758f73af34ecab9c7137939e157aa"}, {"253": "fb39651b71098db2c56fe18ccc3ee2db1e86098f"}, {"254": "fb39651b71098db2c56fe18ccc3ee2db1e86098f"}, {"258": "fb39651b71098db2c56fe18ccc3ee2db1e86098f"}, {"259": "fb39651b71098db2c56fe18ccc3ee2db1e86098f"}, {"260": "fb39651b71098db2c56fe18ccc3ee2db1e86098f"}, {"261": "fb39651b71098db2c56fe18ccc3ee2db1e86098f"}, {"264": "2f35125b9e3131e5a888a58bca72c8b26fe2b9eb"}, {"265": "2f35125b9e3131e5a888a58bca72c8b26fe2b9eb"}, {"266": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}, {"267": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}, {"268": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}, {"269": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}, {"270": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}, {"271": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}, {"272": "a5eaaf2193af96eed3584f9213569faeaa76a61e"}], "ctags": [{"_type": "tag", "name": "APP_LOGGER", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^APP_LOGGER = _configure_logging()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "RequestIDMiddleware", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^class RequestIDMiddleware(BaseHTTPMiddleware):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SafeJSONFormatter", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^class SafeJSONFormatter(logging.Formatter):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_SENSITIVE_KEYS", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^_SENSITIVE_KEYS = {$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_SETTINGS_INTERNAL", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^from src.api.oauth_config import _SETTINGS as _SETTINGS_INTERNAL  # safe import inside backend$/", "language": "Python", "kind": "unknown", "nameref": "unknown:_SETTINGS"}, {"_type": "tag", "name": "_STATE_COOKIE_NAME", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^_STATE_COOKIE_NAME = \"jira_oauth_state\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_STATE_COOKIE_TTL", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^_STATE_COOKIE_TTL = 600  # 10 minutes$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_STATE_SECRET", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^_STATE_SECRET = os.getenv(\"STATE_SIGNING_SECRET\") or os.getenv(\"APP_SECRET_KEY\") or os.getenv(\"S/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_configure_logging", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _configure_logging() -> logging.Logger:$/", "language": "Python", "typeref": "typename:logging.Logger", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_ensure_target_user", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _ensure_target_user(db, request: Request, state: Optional[str]):$/", "language": "Python", "kind": "function", "signature": "(db, request: Request, state: Optional[str])"}, {"_type": "tag", "name": "_env_candidates", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    _env_candidates = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_gen_csrf_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _gen_csrf_state() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_get_headers_subset", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _get_headers_subset(request: Request) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "_loaded", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^                _loaded = False$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_loaded", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    _loaded = False$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_log_event", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _log_event($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( level: int, event: str, request: Request, provider: Optional[str] = None, status_code: Optional[int] = None, **fields: Any, )"}, {"_type": "tag", "name": "_ocean_response", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _ocean_response(data: Any, message: str = \"ok\") -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(data: Any, message: str = \"ok\")"}, {"_type": "tag", "name": "_parse_state_map", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _parse_state_map(state: Optional[str]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(state: Optional[str])"}, {"_type": "tag", "name": "_redact_mapping", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _redact_mapping(mapping: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(mapping: Dict[str, Any])"}, {"_type": "tag", "name": "_redact_value", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _redact_value(_: Any) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(_: Any)"}, {"_type": "tag", "name": "_resolve_user_from_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _resolve_user_from_state(db, state: Optional[str]):$/", "language": "Python", "kind": "function", "signature": "(db, state: Optional[str])"}, {"_type": "tag", "name": "_sanitized_query_params", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _sanitized_query_params(request: Request) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "_should_redact", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _should_redact(key: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(key: str)"}, {"_type": "tag", "name": "_sign_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _sign_state(value: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(value: str)"}, {"_type": "tag", "name": "_verify_signed_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _verify_signed_state(signed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(signed: str)"}, {"_type": "tag", "name": "allowed_frontend_origin", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^allowed_frontend_origin = \"https:\\/\\/vscode-internal-36200-beta.beta01.cloud.kavia.ai:3000\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "atlassian_callback_alias", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^async def atlassian_callback_alias(request: Request, db=Depends(get_db), code: Optional[str] = N/", "language": "Python", "kind": "function", "signature": "(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "configured", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^configured = _SETTINGS_INTERNAL.backend_cors_origins or \"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "configured_list", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^configured_list = [o.strip() for o in configured.split(\",\")] if configured else []$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "confluence_callback", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^async def confluence_callback(request: Request, db=Depends(get_db), code: Optional[str] = None, /", "language": "Python", "kind": "function", "signature": "(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "confluence_callback_api_alias", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^async def confluence_callback_api_alias(request: Request, db=Depends(get_db), code: Optional[str/", "language": "Python", "kind": "function", "signature": "(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "confluence_login", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def confluence_login(request: Request, state: Optional[str] = None, scope: Optional[str] = None)/", "language": "Python", "kind": "function", "signature": "(request: Request, state: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "confluence_login_api_alias", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def confluence_login_api_alias(request: Request, state: Optional[str] = None, scope: Optional[st/", "language": "Python", "kind": "function", "signature": "(request: Request, state: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "connect_confluence", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def connect_confluence(db=Depends(get_db), payload: UserCreate | None = None):$/", "language": "Python", "kind": "function", "signature": "(db=Depends(get_db), payload: UserCreate | None = None)"}, {"_type": "tag", "name": "connect_jira", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def connect_jira(db=Depends(get_db), payload: UserCreate | None = None):$/", "language": "Python", "kind": "function", "signature": "(db=Depends(get_db), payload: UserCreate | None = None)"}, {"_type": "tag", "name": "create_user_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def create_user_endpoint(payload: UserCreate, db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(payload: UserCreate, db=Depends(get_db))"}, {"_type": "tag", "name": "dispatch", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    async def dispatch(self, request: Request, call_next):$/", "language": "Python", "kind": "member", "signature": "(self, request: Request, call_next)", "scope": "RequestIDMiddleware", "scopeKind": "class"}, {"_type": "tag", "name": "fetch_confluence_pages", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def fetch_confluence_pages(db=Depends(get_db), owner_id: int | None = None):$/", "language": "Python", "kind": "function", "signature": "(db=Depends(get_db), owner_id: int | None = None)"}, {"_type": "tag", "name": "fetch_jira_projects", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def fetch_jira_projects(db=Depends(get_db), owner_id: int | None = None):$/", "language": "Python", "kind": "function", "signature": "(db=Depends(get_db), owner_id: int | None = None)"}, {"_type": "tag", "name": "format", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    def format(self, record: logging.LogRecord) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, record: logging.LogRecord)", "scope": "SafeJSONFormatter", "scopeKind": "class"}, {"_type": "tag", "name": "get_user_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def get_user_endpoint(user_id: int, db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(user_id: int, db=Depends(get_db))"}, {"_type": "tag", "name": "global_exception_handler", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^async def global_exception_handler(request: Request, exc: Exception):$/", "language": "Python", "kind": "function", "signature": "(request: Request, exc: Exception)"}, {"_type": "tag", "name": "health_authorize_url_probe", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_authorize_url_probe(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_redirect_pieces", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_redirect_pieces(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "health_redirect_uri", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_redirect_uri():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "healthz", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def healthz():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "jira_callback", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^async def jira_callback($/", "language": "Python", "kind": "function", "signature": "( request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None, )"}, {"_type": "tag", "name": "jira_callback_api_alias", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^async def jira_callback_api_alias(request: Request, db=Depends(get_db), code: Optional[str] = No/", "language": "Python", "kind": "function", "signature": "(request: Request, db=Depends(get_db), code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "jira_login", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def jira_login($/", "language": "Python", "kind": "function", "signature": "( request: Request, state: Optional[str] = None, scope: Optional[str] = None, redirect: Optional[bool] = False, )"}, {"_type": "tag", "name": "jira_login_api_alias", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def jira_login_api_alias($/", "language": "Python", "kind": "function", "signature": "( request: Request, state: Optional[str] = None, scope: Optional[str] = None, redirect: Optional[bool] = False, )"}, {"_type": "tag", "name": "jira_login_options", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def jira_login_options():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_confluence_pages_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def list_confluence_pages_endpoint(owner_id: int, db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(owner_id: int, db=Depends(get_db))"}, {"_type": "tag", "name": "list_jira_projects_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def list_jira_projects_endpoint(owner_id: int, db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(owner_id: int, db=Depends(get_db))"}, {"_type": "tag", "name": "list_users_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def list_users_endpoint(db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(db=Depends(get_db))"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "upsert_confluence_page_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def upsert_confluence_page_endpoint(payload: ConfluencePageCreate, db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(payload: ConfluencePageCreate, db=Depends(get_db))"}, {"_type": "tag", "name": "upsert_jira_project_endpoint", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def upsert_jira_project_endpoint(payload: JiraProjectCreate, db=Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(payload: JiraProjectCreate, db=Depends(get_db))"}], "hash": "82e4e5395b01fd1aeb41c9421cba9049", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/main.py", "fields": [{"name": "APP_LOGGER = _configure_logging()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_SENSITIVE_KEYS = {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_STATE_COOKIE_NAME = \"jira_oauth_state\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_STATE_COOKIE_TTL = 600  # 10 minutes", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_STATE_SECRET = os.getenv(\"STATE_SIGNING_SECRET\") or os.getenv(\"APP_SECRET_KEY\") or os.getenv(\"S/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_env_candidates = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_loaded = False", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allowed_frontend_origin = \"https:\\/\\/vscode-internal-36200-beta.beta01.cloud.kavia.ai:3000\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "configured = _SETTINGS_INTERNAL.backend_cors_origins or \"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "configured_list = [o.strip() for o in configured.split(\",\")] if configured else []", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}]}