{"is_source_file": true, "format": "Python", "description": "Main source file for the backend API of a Jira-Confluence integration project. It initializes the FastAPI application, sets up middleware like CORS and request ID handling, configures logging, defines health check endpoints, and includes routers for OAuth, connectors, and authentication. It also serves static files and favicon, and contains utilities for environment-based configuration and verification endpoints.", "external_files": ["src.db.config", "src.api.oauth_config", "src.api.routers", "src.api.jira_oauth", "src.api.auth"], "external_methods": ["get_jira_oauth_config", "build_atlassian_authorize_url", "get_active_redirect_uris_debug"], "published": ["health_check", "cors_preflight_probe", "health", "healthz", "health_redirect_uri", "health_authorize_url_probe", "health_redirect_pieces"], "classes": [{"name": "SafeJSONFormatter", "description": "Custom logging formatter that outputs a JSON string with request and log details, including timestamp, level, message, and optional request metadata."}, {"name": "RequestIDMiddleware", "description": "Middleware to assign or propagate a unique request ID for each incoming request, adding it to the request state and response headers."}], "methods": [{"name": "logging.Logger _configure_logging()", "description": "Configures and returns a logger with a JSON formatter, based on environment LOG_LEVEL.", "scope": "", "scopeKind": ""}, {"name": "favicon()", "description": "Serves the favicon.ico if available, otherwise returns a 1x1 transparent PNG as fallback.", "scope": "", "scopeKind": ""}, {"name": "health_check()", "description": "Health check endpoint indicating the API service is healthy.", "scope": "", "scopeKind": ""}, {"name": "cors_preflight_probe()", "description": "Basic OPTIONS endpoint to verify CORS preflight behavior.", "scope": "", "scopeKind": ""}, {"name": "health()", "description": "Liveness probe endpoint for container health checks.", "scope": "", "scopeKind": ""}, {"name": "healthz()", "description": "Readiness probe endpoint for container health checks.", "scope": "", "scopeKind": ""}, {"name": "health_redirect_uri()", "description": "Returns the current active redirect URIs for Jira and Confluence as determined by debug configuration.", "scope": "", "scopeKind": ""}, {"name": "health_authorize_url_probe(request: Request)", "description": "Constructs and returns the Jira OAuth authorization URL based on current configuration for verification.", "scope": "", "scopeKind": ""}, {"name": "health_redirect_pieces(request: Request)", "description": "Returns the components used to construct redirect URIs, considering environment variables and forwarded headers.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _ocean_response(data: Any, message: str = \"ok\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dispatch(self, request: Request, call_next)", "scope": "RequestIDMiddleware", "scopeKind": "class", "description": "unavailable"}, {"name": "str format(self, record: logging.LogRecord)", "scope": "SafeJSONFormatter", "scopeKind": "class", "description": "unavailable"}], "calls": ["json.dumps", "datetime.now", "os.getenv", "os.path.abspath", "os.path.dirname", "os.path.join", "os.path.isfile", "base64.b64decode", "urllib.parse.quote", "urllib.parse.urlparse", "logging.getLogger", "logging.StreamHandler", "app.include_router", "app.mount", "app.add_middleware", "Base.metadata.create_all"], "search-terms": ["FastAPI", "OAuth", "Jira", "Confluence", "health check", "middleware", "request ID", "CORS", "static files", "OAuth config"], "state": 2, "file_id": 1, "knowledge_revision": 478, "git_revision": "6b46f5ba70b75218085833838f4131cbb2490274", "revision_history": [{"7": "3ddbecfdaea73dec9c7dc9e5f607ebdc11919216"}, {"18": "3ddbecfdaea73dec9c7dc9e5f607ebdc11919216"}, {"22": "5e41eb50619ad398f0acd99dcd0f280e619e1f8c"}, {"24": "5e41eb50619ad398f0acd99dcd0f280e619e1f8c"}, {"30": "28dac5a32d269d73eee9c3668810d8ab5eec8ee9"}, {"31": "7fbfd021c4802e87c6da87c524fde505c2578f38"}, {"32": "7fbfd021c4802e87c6da87c524fde505c2578f38"}, {"41": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"42": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"43": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"44": "7897077d84c2ca38be0902a71478cec76a5f5ad0"}, {"47": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"48": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"53": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"56": "8c69d0e627c970866f887e455b3fe92fd2ca45e7"}, {"58": "ce9dd25068e5bd76fdddef3c3666432880c7a53d"}, {"478": "6b46f5ba70b75218085833838f4131cbb2490274"}], "ctags": [{"_type": "tag", "name": "APP_LOGGER", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^APP_LOGGER = _configure_logging()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "RequestIDMiddleware", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^class RequestIDMiddleware(BaseHTTPMiddleware):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SafeJSONFormatter", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^class SafeJSONFormatter(logging.Formatter):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_configure_logging", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _configure_logging() -> logging.Logger:$/", "language": "Python", "typeref": "typename:logging.Logger", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_ocean_response", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def _ocean_response(data: Any, message: str = \"ok\") -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(data: Any, message: str = \"ok\")"}, {"_type": "tag", "name": "allow_credentials", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^allow_credentials = True$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "allowed_origins", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    allowed_origins = []$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "allowed_origins", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^allowed_origins = [o.strip() for o in allowed_origins_raw.split(\",\") if o and o.strip()] if allo/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "allowed_origins_raw", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^allowed_origins_raw = ($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^from src.api.auth import router as auth_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "connectors_router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^from src.api.routers import connectors as connectors_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:connectors"}, {"_type": "tag", "name": "cors_preflight_probe", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def cors_preflight_probe():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "dispatch", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    async def dispatch(self, request: Request, call_next):$/", "language": "Python", "kind": "member", "signature": "(self, request: Request, call_next)", "scope": "RequestIDMiddleware", "scopeKind": "class"}, {"_type": "tag", "name": "favicon", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def favicon():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "format", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^    def format(self, record: logging.LogRecord) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, record: logging.LogRecord)", "scope": "SafeJSONFormatter", "scopeKind": "class"}, {"_type": "tag", "name": "health", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_authorize_url_probe", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_authorize_url_probe(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_redirect_pieces", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_redirect_pieces(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "health_redirect_uri", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def health_redirect_uri():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "healthz", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^def healthz():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "jira_oauth_router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^from src.api.jira_oauth import router as jira_oauth_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "static_dir", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/main.py", "pattern": "/^static_dir = os.path.abspath(os.path.join(os.path.dirname(os.path.dirname(__file__)), \"..\", \"sta/", "language": "Python", "kind": "variable"}], "hash": "8acc8a9b9daf5f91dc5afc6be3ab5f91", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/main.py", "fields": [{"name": "APP_LOGGER = _configure_logging()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allow_credentials = True", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allowed_origins = []", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allowed_origins = [o.strip() for o in allowed_origins_raw.split(\",\") if o and o.strip()] if allo/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allowed_origins_raw = (", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "static_dir = os.path.abspath(os.path.join(os.path.dirname(os.path.dirname(__file__)), \"..\", \"sta/", "scope": "", "scopeKind": "", "description": "unavailable"}]}