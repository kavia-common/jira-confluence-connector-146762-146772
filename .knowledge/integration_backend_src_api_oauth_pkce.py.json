{"is_source_file": true, "format": "Python", "description": "This Python source file provides utilities for implementing OAuth 2.0 PKCE flows, including code verifier and challenge generation, CSRF state management, and a simple in-memory session store for OAuth sessions. It defines functions for handling OAuth sessions and tokens, and includes data classes for session and token data.", "external_files": ["oauth_settings.py"], "external_methods": ["secrets.token_urlsafe", "hashlib.sha256", "base64.urlsafe_b64encode", "os.urandom", "time.time()"], "published": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "export_session_debug"], "classes": [{"name": "TokenSet", "description": "Data class representing an OAuth token set including access token, refresh token, token type, scope, expiry info, and method to check expiration."}, {"name": "SessionData", "description": "Data class representing an OAuth session, including state, code verifier, and optional token set."}], "methods": [{"name": "str _b64url_nopad(data: bytes)", "description": "Encodes bytes to a URL-safe base64 string without padding.", "scope": "", "scopeKind": ""}, {"name": "dict export_session_debug(session_id: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str generate_code_challenge(code_verifier: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str generate_code_verifier(length: int = 64)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str generate_state(length: int = 32)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str get_or_create_session_id(existing: Optional[str])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[SessionData] get_session(session_id: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool is_expired(self)", "scope": "TokenSet", "scopeKind": "class", "description": "unavailable"}, {"name": "None save_session(session_id: str, session: SessionData)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TokenSet save_tokens(session_id: str, token_json: dict)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["base64.urlsafe_b64encode", "hashlib.sha256", "os.urandom", "secrets.token_urlsafe", "secrets.token_bytes", "time.time"], "search-terms": ["PKCE", "OAuth 2.0", "code_verifier", "code_challenge", "CSRF", "session store", "in-memory session", "TokenSet", "SessionData", "oauth_settings"], "state": 2, "file_id": 13, "knowledge_revision": 59, "git_revision": "837fa352878d17e969ace40bf39f6914f4a39086", "revision_history": [{"50": ""}, {"59": "837fa352878d17e969ace40bf39f6914f4a39086"}], "ctags": [{"_type": "tag", "name": "SessionData", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^class SessionData:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TokenSet", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^class TokenSet:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_SESSION_STORE", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^_SESSION_STORE: Dict[str, SessionData] = {}$/", "language": "Python", "typeref": "typename:Dict[str, SessionData]", "kind": "variable"}, {"_type": "tag", "name": "_b64url_nopad", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def _b64url_nopad(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "export_session_debug", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def export_session_debug(session_id: str) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(session_id: str)"}, {"_type": "tag", "name": "generate_code_challenge", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def generate_code_challenge(code_verifier: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(code_verifier: str)"}, {"_type": "tag", "name": "generate_code_verifier", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def generate_code_verifier(length: int = 64) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(length: int = 64)"}, {"_type": "tag", "name": "generate_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def generate_state(length: int = 32) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(length: int = 32)"}, {"_type": "tag", "name": "get_or_create_session_id", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def get_or_create_session_id(existing: Optional[str]) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(existing: Optional[str])"}, {"_type": "tag", "name": "get_session", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def get_session(session_id: str) -> Optional[SessionData]:$/", "language": "Python", "typeref": "typename:Optional[SessionData]", "kind": "function", "signature": "(session_id: str)"}, {"_type": "tag", "name": "is_expired", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^    def is_expired(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "TokenSet", "scopeKind": "class"}, {"_type": "tag", "name": "save_session", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def save_session(session_id: str, session: SessionData) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(session_id: str, session: SessionData)"}, {"_type": "tag", "name": "save_tokens", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def save_tokens(session_id: str, token_json: dict) -> TokenSet:$/", "language": "Python", "typeref": "typename:TokenSet", "kind": "function", "signature": "(session_id: str, token_json: dict)"}, {"_type": "tag", "name": "token_set", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^    token_set: Optional[TokenSet] = None$/", "language": "Python", "typeref": "typename:Optional[TokenSet]", "kind": "variable", "scope": "SessionData", "scopeKind": "class"}], "hash": "694922a42118ad661b98e159843a323e", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_pkce.py", "fields": [{"name": "Dict[str, SessionData] _SESSION_STORE", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[TokenSet] token_set", "scope": "SessionData", "scopeKind": "class", "description": "unavailable"}]}