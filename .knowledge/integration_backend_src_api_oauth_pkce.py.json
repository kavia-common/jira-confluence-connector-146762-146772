{"is_source_file": true, "format": "Python", "description": "This file provides utilities for implementing OAuth 2.0 PKCE flows, including code verifier and challenge generation, CSRF state generation, and a simple in-memory session store for handling OAuth sessions during development.", "external_files": ["oauth_settings.py"], "external_methods": [], "published": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "export_session_debug"], "classes": [{"name": "TokenSet", "description": "Data class representing OAuth token details including access token, refresh token, token type, scope, expiration, and obtain time."}, {"name": "SessionData", "description": "Data class storing the OAuth session's state, code verifier, and associated tokens."}], "methods": [{"name": "str generate_code_verifier(length: int = 64)", "description": "Generates a high-entropy code_verifier string for PKCE, default length 64.", "scope": "", "scopeKind": ""}, {"name": "str generate_code_challenge(code_verifier: str)", "description": "Computes the SHA-256 based code_challenge from code_verifier as per RFC 7636.", "scope": "", "scopeKind": ""}, {"name": "str generate_state(length: int = 32)", "description": "Creates a random state string for CSRF protection.", "scope": "", "scopeKind": ""}, {"name": "str get_or_create_session_id(existing: Optional[str])", "description": "Retrieves existing session ID or creates a new secure random one.", "scope": "", "scopeKind": ""}, {"name": "None save_session(session_id: str, session: SessionData)", "description": "Stores session data in the in-memory store.", "scope": "", "scopeKind": ""}, {"name": "Optional[SessionData] get_session(session_id: str)", "description": "Retrieves session data by session ID.", "scope": "", "scopeKind": ""}, {"name": "TokenSet save_tokens(session_id: str, token_json: dict)", "description": "Stores OAuth token information into the session, creating a new session if necessary.", "scope": "", "scopeKind": ""}, {"name": "dict export_session_debug(session_id: str)", "description": "Returns a sanitized debug view of the session, excluding sensitive token information.", "scope": "", "scopeKind": ""}, {"name": "str _b64url_nopad(data: bytes)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool is_expired(self)", "scope": "TokenSet", "scopeKind": "class", "description": "unavailable"}], "calls": ["base64.urlsafe_b64encode", "hashlib.sha256", "os.urandom", "secrets.token_urlsafe", "secrets.token_bytes", "time.time"], "search-terms": ["PKCE", "oauth", "session store", "code_verifier", "code_challenge", "CSRF", "session_id", "OAuth 2.0 in-memory store", "PKCE utilities"], "state": 2, "file_id": 13, "knowledge_revision": 50, "git_revision": "", "ctags": [{"_type": "tag", "name": "SessionData", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^class SessionData:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TokenSet", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^class TokenSet:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_SESSION_STORE", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^_SESSION_STORE: Dict[str, SessionData] = {}$/", "language": "Python", "typeref": "typename:Dict[str, SessionData]", "kind": "variable"}, {"_type": "tag", "name": "_b64url_nopad", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def _b64url_nopad(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "export_session_debug", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def export_session_debug(session_id: str) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(session_id: str)"}, {"_type": "tag", "name": "generate_code_challenge", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def generate_code_challenge(code_verifier: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(code_verifier: str)"}, {"_type": "tag", "name": "generate_code_verifier", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def generate_code_verifier(length: int = 64) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(length: int = 64)"}, {"_type": "tag", "name": "generate_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def generate_state(length: int = 32) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(length: int = 32)"}, {"_type": "tag", "name": "get_or_create_session_id", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def get_or_create_session_id(existing: Optional[str]) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(existing: Optional[str])"}, {"_type": "tag", "name": "get_session", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def get_session(session_id: str) -> Optional[SessionData]:$/", "language": "Python", "typeref": "typename:Optional[SessionData]", "kind": "function", "signature": "(session_id: str)"}, {"_type": "tag", "name": "is_expired", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^    def is_expired(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "TokenSet", "scopeKind": "class"}, {"_type": "tag", "name": "save_session", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def save_session(session_id: str, session: SessionData) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(session_id: str, session: SessionData)"}, {"_type": "tag", "name": "save_tokens", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^def save_tokens(session_id: str, token_json: dict) -> TokenSet:$/", "language": "Python", "typeref": "typename:TokenSet", "kind": "function", "signature": "(session_id: str, token_json: dict)"}, {"_type": "tag", "name": "token_set", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_pkce.py", "pattern": "/^    token_set: Optional[TokenSet] = None$/", "language": "Python", "typeref": "typename:Optional[TokenSet]", "kind": "variable", "scope": "SessionData", "scopeKind": "class"}], "hash": "acb2e7fd9fdcef205c47e3ae3b754d84", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_pkce.py", "fields": [{"name": "Dict[str, SessionData] _SESSION_STORE", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[TokenSet] token_set", "scope": "SessionData", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"50": ""}]}