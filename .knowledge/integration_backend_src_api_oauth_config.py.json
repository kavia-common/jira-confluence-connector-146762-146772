{"is_source_file": true, "format": "Python", "description": "This file provides configuration utilities and environment variable handling for OAuth flows with Atlassian products (JIRA and Confluence). It loads environment variables, validates URLs, and constructs OAuth configuration dictionaries and URLs. It also includes debug functions for environment diagnostics.", "external_files": ["dotenv", "os", "urllib.parse", "typing", "pydantic"], "external_methods": ["load_dotenv", "find_dotenv", "os.getenv", "os.path.dirname", "os.path.join", "os.path.normpath", "os.path.isfile", "urllib.parse.urlparse", "urllib.parse.urlencode"], "published": ["get_atlassian_base_url", "get_jira_oauth_config", "get_confluence_oauth_config", "get_frontend_base_url_default", "is_jira_oauth_configured", "build_atlassian_authorize_url", "get_jira_oauth_env_debug", "get_env_bootstrap_debug", "get_active_redirect_uris_debug"], "classes": [{"name": "Settings", "description": "A Pydantic data model that encapsulates OAuth and general environment-based configuration settings, including URLs, secrets, and flags."}], "methods": [{"name": "None _load_env_once()", "description": "Attempts to load environment variables from various .env locations, with caching to avoid repeated loads.", "scope": "", "scopeKind": ""}, {"name": "str _env_first(*names: str)", "description": "Returns the first non-empty environment variable value from provided names, used for configuration fallbacks.", "scope": "", "scopeKind": ""}, {"name": "str _mask_secret(value: Optional[str], keep: int = 4)", "description": "Masks secrets by replacing all but the last few characters with asterisks for debug output.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Optional[str]] _analyze_url(uri: str)", "description": "Parses and analyzes a URL for validity and components, returning a dict with details, used for debugging URL correctness.", "scope": "", "scopeKind": ""}, {"name": "bool _is_truthy(val: Optional[str | bool])", "description": "Determines if a given string or boolean represents a truthy value (e.g., 'true', '1').", "scope": "", "scopeKind": ""}, {"name": "Tuple[str,Optional[str]] _resolve_env(names: List[str])", "description": "Resolves the first set environment variable among a list of candidate names.", "scope": "", "scopeKind": ""}, {"name": "str get_atlassian_base_url()", "description": "Returns the base URL for Atlassian (Jira/Confluence), as configured via environment.", "scope": "", "scopeKind": ""}, {"name": "str _choose_canonical_redirect(default_path: str)", "description": "Selects the redirect URI for OAuth, prioritizing environment setting, then falling back to a default URL.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] get_jira_oauth_config()", "description": "Returns a dict with Jira OAuth configuration: client ID, secret, redirect URI, base URL, and environment flags.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] get_confluence_oauth_config()", "description": "Returns a dict with Confluence OAuth configuration, including URL fallbacks.", "scope": "", "scopeKind": ""}, {"name": "str get_frontend_base_url_default()", "description": "Returns the default frontend URL for redirecting post-auth.", "scope": "", "scopeKind": ""}, {"name": "bool is_jira_oauth_configured()", "description": "Checks if the Jira OAuth configuration has all required fields (client ID, secret, redirect URI).", "scope": "", "scopeKind": ""}, {"name": "str build_atlassian_authorize_url(client_id: str, redirect_uri: str, scopes: str, state: Optional[str] = None)", "description": "Constructs an OAuth authorization URL for Atlassian with provided parameters and scopes.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Dict[str,str]] get_jira_oauth_env_debug()", "description": "Returns masked and source-aware environment variable info for debugging Jira OAuth setup.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] get_env_bootstrap_debug()", "description": "Provides info on whether dotenv was loaded, from which path, and environment mode details.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Dict[str,str]] get_active_redirect_uris_debug()", "description": "Displays which redirect URIs are active for Jira and Confluence, along with URL component analysis.", "scope": "", "scopeKind": ""}], "calls": ["load_dotenv", "find_dotenv", "os.getenv", "os.path.dirname", "os.path.join", "os.path.normpath", "os.path.isfile", "urllib.parse.urlparse", "urllib.parse.urlencode"], "search-terms": ["oauth_config", "Atlassian OAuth", "Jira OAuth", "Confluence OAuth", ".env load", "redirect URI", "environment configuration", "OAuth URLs", "environment variable resolution", "OAuth debug"], "state": 2, "file_id": 12, "knowledge_revision": 243, "git_revision": "edffa28eb1150a3ca91ed855c6f59fb26c0ef310", "revision_history": [{"38": ""}, {"54": "906ba192e73f2ea439ac8fce13c4ec73b18ccf62"}, {"243": "edffa28eb1150a3ca91ed855c6f59fb26c0ef310"}], "ctags": [{"_type": "tag", "name": "ATLASSIAN_BASE_ENV_CANDIDATES", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^ATLASSIAN_BASE_ENV_CANDIDATES: List[str] = [$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable"}, {"_type": "tag", "name": "FRONTEND_URL_ENV_CANDIDATES", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^FRONTEND_URL_ENV_CANDIDATES: List[str] = [$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable"}, {"_type": "tag", "name": "JIRA_ID_ENV_CANDIDATES", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^JIRA_ID_ENV_CANDIDATES: List[str] = [$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable"}, {"_type": "tag", "name": "JIRA_REDIRECT_ENV_CANDIDATES", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^JIRA_REDIRECT_ENV_CANDIDATES: List[str] = [$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable"}, {"_type": "tag", "name": "JIRA_SECRET_ENV_CANDIDATES", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^JIRA_SECRET_ENV_CANDIDATES: List[str] = [$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable"}, {"_type": "tag", "name": "Settings", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^class Settings(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_DOTENV_STATUS", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^_DOTENV_STATUS: Dict[str, Optional[str]] = {\"loaded\": \"false\", \"path\": None}$/", "language": "Python", "typeref": "typename:Dict[str, Optional[str]]", "kind": "variable"}, {"_type": "tag", "name": "_SETTINGS", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^_SETTINGS = Settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_analyze_url", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _analyze_url(uri: str) -> Dict[str, Optional[str]]:$/", "language": "Python", "typeref": "typename:Dict[str,Optional[str]]", "kind": "function", "signature": "(uri: str)"}, {"_type": "tag", "name": "_choose_canonical_redirect", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _choose_canonical_redirect(default_path: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(default_path: str)"}, {"_type": "tag", "name": "_env_first", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _env_first(*names: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*names: str)"}, {"_type": "tag", "name": "_is_truthy", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _is_truthy(val: Optional[str | bool]) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(val: Optional[str | bool])"}, {"_type": "tag", "name": "_load_env_once", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _load_env_once() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_mask_secret", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _mask_secret(value: Optional[str], keep: int = 4) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(value: Optional[str], keep: int = 4)"}, {"_type": "tag", "name": "_resolve_env", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def _resolve_env(names: List[str]) -> Tuple[str, Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[str,Optional[str]]", "kind": "function", "signature": "(names: List[str])"}, {"_type": "tag", "name": "app_env", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    app_env: str = Field(default=os.getenv(\"APP_ENV\", os.getenv(\"ENV\", \"production\")))$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "atlassian_base_url", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    atlassian_base_url: Optional[str] = Field(default=_env_first(\"ATLASSIAN_CLOUD_BASE_URL\", \"NE/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "backend_cors_origins", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    backend_cors_origins: str = Field(default=os.getenv(\"BACKEND_CORS_ORIGINS\", os.getenv(\"NEXT_/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "build_atlassian_authorize_url", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def build_atlassian_authorize_url(client_id: str, redirect_uri: str, scopes: str, state: Optiona/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(client_id: str, redirect_uri: str, scopes: str, state: Optional[str] = None)"}, {"_type": "tag", "name": "confluence_client_id", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    confluence_client_id: Optional[str] = Field(default=_env_first(\"CONFLUENCE_OAUTH_CLIENT_ID\",/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "confluence_client_secret", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    confluence_client_secret: Optional[str] = Field(default=_env_first(\"CONFLUENCE_OAUTH_CLIENT_/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "confluence_redirect_uri", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    confluence_redirect_uri: Optional[str] = Field(default=_env_first(\"ATLASSIAN_OAUTH_REDIRECT_/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "dev_mode", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    dev_mode: bool = Field(default=os.getenv(\"DEV_MODE\", \"false\").lower() in (\"1\", \"true\", \"yes\"/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "find_dotenv", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    find_dotenv = None  # type: ignore$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "frontend_url", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    frontend_url: Optional[str] = Field(default=_env_first(\"APP_FRONTEND_URL\", \"NEXT_PUBLIC_APP_/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "get_active_redirect_uris_debug", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_active_redirect_uris_debug() -> Dict[str, Dict[str, str]]:$/", "language": "Python", "typeref": "typename:Dict[str,Dict[str,str]]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_atlassian_base_url", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_atlassian_base_url() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_confluence_oauth_config", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_confluence_oauth_config() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_env_bootstrap_debug", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_env_bootstrap_debug() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_frontend_base_url_default", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_frontend_base_url_default() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_jira_oauth_config", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_jira_oauth_config() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_jira_oauth_env_debug", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def get_jira_oauth_env_debug() -> Dict[str, Dict[str, str]]:$/", "language": "Python", "typeref": "typename:Dict[str,Dict[str,str]]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "is_jira_oauth_configured", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^def is_jira_oauth_configured() -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "jira_client_id", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    jira_client_id: Optional[str] = Field(default=_env_first(\"JIRA_OAUTH_CLIENT_ID\", \"ATLASSIAN_/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "jira_client_secret", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    jira_client_secret: Optional[str] = Field(default=_env_first(\"JIRA_OAUTH_CLIENT_SECRET\", \"AT/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "jira_redirect_uri", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    jira_redirect_uri: Optional[str] = Field(default=_env_first(\"JIRA_REDIRECT_URI\"))$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Settings", "scopeKind": "class"}, {"_type": "tag", "name": "load_dotenv", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    load_dotenv = None  # type: ignore$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "log_level", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_config.py", "pattern": "/^    log_level: str = Field(default=os.getenv(\"LOG_LEVEL\", \"INFO\"))$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Settings", "scopeKind": "class"}], "hash": "e8cbb7a68ab4eabe3c521ffa4106ee9d", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_config.py", "fields": [{"name": "List[str] ATLASSIAN_BASE_ENV_CANDIDATES", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] FRONTEND_URL_ENV_CANDIDATES", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] JIRA_ID_ENV_CANDIDATES", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] JIRA_REDIRECT_ENV_CANDIDATES", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] JIRA_SECRET_ENV_CANDIDATES", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, Optional[str]] _DOTENV_STATUS", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_SETTINGS = Settings()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str app_env", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] atlassian_base_url", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "str backend_cors_origins", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] confluence_client_id", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] confluence_client_secret", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] confluence_redirect_uri", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "bool dev_mode", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "find_dotenv = None  # type: ignore", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] frontend_url", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] jira_client_id", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] jira_client_secret", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] jira_redirect_uri", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}, {"name": "load_dotenv = None  # type: ignore", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str log_level", "scope": "Settings", "scopeKind": "class", "description": "unavailable"}]}