{"is_source_file": true, "format": "Python", "description": "This file is a test module for OAuth callback handling in a FastAPI application. It sets up environment variables, defines dummy classes to mock HTTP responses, and contains multiple test functions to validate OAuth callback behavior for Jira and Confluence integrations within the project.", "external_files": ["src.api.main", "src.db.config", "src.db.models"], "external_methods": ["fastapi.testclient.TestClient", "httpx.AsyncClient"], "published": ["test_jira_callback_accepts_standard_state_without_raw_state", "test_jira_callback_accepts_missing_state_query_param", "test_jira_callback_creates_placeholder_user_when_none", "test_jira_callback_uses_user_id_from_state", "test_confluence_callback_creates_placeholder_user_when_none"], "classes": [{"name": "DummyResp", "description": "A mock response object to simulate the HTTP responses from httpx.AsyncClient, particularly for token exchange responses."}, {"name": "DummyAsyncClient", "description": "A mock async HTTP client that simulates the behavior of httpx.AsyncClient, always returning a successful token response."}], "methods": [{"name": "DummyResp.__init__", "description": "Initializes a dummy response with a payload and a status code."}, {"name": "DummyResp.json", "description": "Returns the stored payload as JSON."}, {"name": "DummyAsyncClient.__init__", "description": "Initializes the dummy async client."}, {"name": "DummyAsyncClient.__aenter__", "description": "Enters the async context manager."}, {"name": "DummyAsyncClient.__aexit__", "description": "Exits the async context manager."}, {"name": "DummyAsyncClient.post", "description": "Simulates posting to an endpoint, always returning a successful token response."}, {"name": "__aenter__(self)", "scope": "DummyAsyncClient", "scopeKind": "class", "description": "unavailable"}, {"name": "__aexit__(self, exc_type, exc, tb)", "scope": "DummyAsyncClient", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self, *args, **kwargs)", "scope": "DummyAsyncClient", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self, payload: dict[str, Any], status_code: int = 200)", "scope": "DummyResp", "scopeKind": "class", "description": "unavailable"}, {"name": "_clear_users()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_patch_httpx(monkeypatch)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "json(self)", "scope": "DummyResp", "scopeKind": "class", "description": "unavailable"}, {"name": "post(self, url, json_payload=None, headers=None)", "scope": "DummyAsyncClient", "scopeKind": "class", "description": "unavailable"}, {"name": "test_confluence_callback_creates_placeholder_user_when_none(monkeypatch)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "test_jira_callback_accepts_missing_state_query_param(monkeypatch)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "test_jira_callback_accepts_standard_state_without_raw_state(monkeypatch)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "test_jira_callback_creates_placeholder_user_when_none(monkeypatch)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "test_jira_callback_uses_user_id_from_state(monkeypatch)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["os.path.abspath", "os.path.join", "sys.path.append", "os.path.exists", "os.remove", "os.environ.__setitem__", "httpx.AsyncClient", "fastapi.testclient.TestClient", "src.api.main.app", "src.db.config.SessionLocal", "src.db.models.User"], "search-terms": ["test_oauth_callbacks", "Jira OAuth", "Confluence OAuth", "OAuth callback testing", "FastAPI test client", "mock async HTTP client", "environment setup for tests", "user token storage in tests"], "state": 2, "file_id": 16, "knowledge_revision": 278, "git_revision": "4a849ed9beef575377c5b4326db6d29a340a0599", "revision_history": [{"106": ""}, {"112": "d17636374379257ba72b67228f5085372200c751"}, {"121": "d17636374379257ba72b67228f5085372200c751"}, {"127": "26585c70d51c695043da52f7d66c117f43aac048"}, {"128": "26585c70d51c695043da52f7d66c117f43aac048"}, {"232": "26585c70d51c695043da52f7d66c117f43aac048"}, {"278": "4a849ed9beef575377c5b4326db6d29a340a0599"}], "ctags": [{"_type": "tag", "name": "BASE_DIR", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), \"..\"))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DummyAsyncClient", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^class DummyAsyncClient:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "DummyResp", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^class DummyResp:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TEST_DB_PATH", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^TEST_DB_PATH = os.path.join(BASE_DIR, \"test_integration.db\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "__aenter__", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^    async def __aenter__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "DummyAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "__aexit__", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^    async def __aexit__(self, exc_type, exc, tb):$/", "language": "Python", "kind": "member", "signature": "(self, exc_type, exc, tb)", "scope": "DummyAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^    def __init__(self, *args, **kwargs):$/", "language": "Python", "kind": "member", "signature": "(self, *args, **kwargs)", "scope": "DummyAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^    def __init__(self, payload: dict[str, Any], status_code: int = 200):$/", "language": "Python", "kind": "member", "signature": "(self, payload: dict[str, Any], status_code: int = 200)", "scope": "DummyResp", "scopeKind": "class"}, {"_type": "tag", "name": "_clear_users", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def _clear_users():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_patch_httpx", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def _patch_httpx(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}, {"_type": "tag", "name": "json", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^    def json(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "DummyResp", "scopeKind": "class"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^    async def post(self, url, json_payload=None, headers=None):$/", "language": "Python", "kind": "member", "signature": "(self, url, json_payload=None, headers=None)", "scope": "DummyAsyncClient", "scopeKind": "class"}, {"_type": "tag", "name": "test_confluence_callback_creates_placeholder_user_when_none", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def test_confluence_callback_creates_placeholder_user_when_none(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}, {"_type": "tag", "name": "test_jira_callback_accepts_missing_state_query_param", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def test_jira_callback_accepts_missing_state_query_param(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}, {"_type": "tag", "name": "test_jira_callback_accepts_standard_state_without_raw_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def test_jira_callback_accepts_standard_state_without_raw_state(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}, {"_type": "tag", "name": "test_jira_callback_creates_placeholder_user_when_none", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def test_jira_callback_creates_placeholder_user_when_none(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}, {"_type": "tag", "name": "test_jira_callback_uses_user_id_from_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/tests/test_oauth_callbacks.py", "pattern": "/^def test_jira_callback_uses_user_id_from_state(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}], "hash": "c164b02e9eca92ed07951b315224262b", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/tests/test_oauth_callbacks.py", "fields": [{"name": "BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), \"..\"))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_DB_PATH = os.path.join(BASE_DIR, \"test_integration.db\")", "scope": "", "scopeKind": "", "description": "unavailable"}]}