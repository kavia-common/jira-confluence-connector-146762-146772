{"is_source_file": true, "format": "Python", "description": "This source file implements OAuth 2.0 authentication flow for Atlassian (Jira/Confluence) using FastAPI. It provides endpoints to initiate OAuth login with return_url handling, handle callback to validate state, exchange code for tokens, and perform diagnostics. It uses in-memory or Redis storage for state and session management.", "external_files": ["./oauth_settings", "./oauth_pkce", "./redis_client"], "external_methods": ["get_atlassian_oauth_config", "get_default_scopes", "generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "save_tokens", "get_session", "SessionData", "save_oauth_state", "consume_oauth_state", "export_oauth_state_diagnostics", "get_state_ttl_seconds", "has_redis"], "published": ["oauth_atlassian_login", "oauth_atlassian_callback", "oauth_diagnostics", "oauth_state_debug"], "classes": [{"name": "SessionData", "description": "Data class representing OAuth session information, including state, code verifier, and tokens."}], "methods": [{"name": "bool _is_absolute_url(url: str | None)", "description": "Checks if a URL string is an absolute URL with http or https scheme.", "scope": "", "scopeKind": ""}, {"name": "str _encode_message(message: str)", "description": "URL encodes a message string for safe inclusion in query parameters.", "scope": "", "scopeKind": ""}, {"name": "str _mask_state(state: str)", "description": "Returns a masked or abbreviated representation of a state string for logging.", "scope": "", "scopeKind": ""}, {"name": "oauth_atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth_atlassian_login(request: Request, return_url: Optional[str] = None, scope: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth_diagnostics()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth_state_debug(state: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["get_atlassian_oauth_config()", "get_default_scopes()", "generate_code_verifier()", "generate_code_challenge()", "generate_state()", "get_or_create_session_id()", "save_session()", "save_oauth_state()", "urllib.parse.urlparse()", "urllib.parse.urlencode()", "has_redis()", "get_state_ttl_seconds()", "consume_oauth_state()", "export_oauth_state_diagnostics()", "save_tokens()", "get_session()", "httpx.AsyncClient()", "logger.info()", "logger.warning()", "logger.error()", "logger.exception()", "RedirectResponse()", "HTTPException()", "JSONResponse()"], "search-terms": ["OAuth", "Atlassian", "PKCE", "OAuth callback", "state management", "return_url handling", "FastAPI OAuth", "redis storage", "session tokens", "authorization code exchange"], "state": 2, "file_id": 26, "knowledge_revision": 196, "git_revision": "90e172c343a497d7aba4e19da17b4ab2d3abb934", "revision_history": [{"144": ""}, {"151": "6b909d8b8bea072b4648907235ef6d3f922152e3"}, {"154": "6b909d8b8bea072b4648907235ef6d3f922152e3"}, {"155": "6b909d8b8bea072b4648907235ef6d3f922152e3"}, {"156": "6b909d8b8bea072b4648907235ef6d3f922152e3"}, {"158": "578c6d17f21ec36ed0102cc502cf09a5c6fadef5"}, {"160": "578c6d17f21ec36ed0102cc502cf09a5c6fadef5"}, {"178": "fbdd2f8fe4834de9017aaae09b7b748f04568b6c"}, {"182": "56fe4bfe23393285f6c027815fe884f9d25c3ab3"}, {"183": "56fe4bfe23393285f6c027815fe884f9d25c3ab3"}, {"184": "56fe4bfe23393285f6c027815fe884f9d25c3ab3"}, {"186": "56fe4bfe23393285f6c027815fe884f9d25c3ab3"}, {"187": "56fe4bfe23393285f6c027815fe884f9d25c3ab3"}, {"188": "56fe4bfe23393285f6c027815fe884f9d25c3ab3"}, {"191": "16ede0da1cb5d681c89b4c436fa9519fb6fce853"}, {"192": "16ede0da1cb5d681c89b4c436fa9519fb6fce853"}, {"193": "16ede0da1cb5d681c89b4c436fa9519fb6fce853"}, {"194": "16ede0da1cb5d681c89b4c436fa9519fb6fce853"}, {"195": "90e172c343a497d7aba4e19da17b4ab2d3abb934"}, {"196": "90e172c343a497d7aba4e19da17b4ab2d3abb934"}], "ctags": [{"_type": "tag", "name": "_encode_message", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^def _encode_message(message: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(message: str)"}, {"_type": "tag", "name": "_is_absolute_url", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^def _is_absolute_url(url: str | None) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(url: str | None)"}, {"_type": "tag", "name": "_mask_state", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^def _mask_state(state: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(state: str)"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^logger = logging.getLogger(\"oauth.return\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "oauth_atlassian_callback", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^async def oauth_atlassian_callback(request: Request, code: Optional[str] = None, state: Optional/", "language": "Python", "kind": "function", "signature": "(request: Request, code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "oauth_atlassian_login", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^async def oauth_atlassian_login(request: Request, return_url: Optional[str] = None, scope: Optio/", "language": "Python", "kind": "function", "signature": "(request: Request, return_url: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "oauth_diagnostics", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^async def oauth_diagnostics():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "oauth_state_debug", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^async def oauth_state_debug(state: Optional[str] = None):$/", "language": "Python", "kind": "function", "signature": "(state: Optional[str] = None)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_return_flow.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}], "hash": "bce94b07753c60a2548c17482026b94d", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_return_flow.py", "fields": [{"name": "logger = logging.getLogger(\"oauth.return\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}]}