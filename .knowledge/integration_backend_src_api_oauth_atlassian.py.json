{"is_source_file": true, "format": "Python", "description": "This file provides FastAPI route handlers for managing OAuth 2.0 authentication with Atlassian (Jira and Confluence), including both PKCE and legacy flows. It handles initiation of login, callback processing, token refresh, resource listing, route diagnostics, and configuration diagnostics. It integrates external OAuth and session management modules, and defines multiple API endpoints for OAuth workflows, route listing, and configuration validation.", "external_files": ["./oauth_pkce", "./oauth_settings", "./oauth_config"], "external_methods": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "get_atlassian_oauth_config", "get_default_scopes", "get_jira_oauth_config", "get_frontend_base_url_default"], "published": ["/api/auth/jira/login", "/auth/jira/login", "/api/oauth/atlassian/login", "/api/oauth/start", "/routes", "/api/oauth/callback/atlassian", "/api/oauth/atlassian/refresh", "/api/atlassian/resources", "/auth/jira/callback", "/api/config"], "classes": [], "methods": [{"name": "jira_login_alias(request: Request, state: Optional[str] = None, scope: Optional[str] = None, return_url: Optional[str] = None)", "description": "Handler for legacy alias redirecting to /auth/jira/login, preserving query parameters.", "scope": "", "scopeKind": ""}, {"name": "None _set_session_cookie(resp: Response, session_id: str)", "description": "Utility to set session cookie 'sid' with security attributes.", "scope": "", "scopeKind": ""}, {"name": "atlassian_login(request: Request, state: Optional[str] = None, scope: Optional[str] = None)", "description": "Initiates OAuth 2.0 flow with PKCE for Atlassian; generates codes and redirects to auth endpoint.", "scope": "", "scopeKind": ""}, {"name": "jira_login_legacy(state: Optional[str] = None, scope: Optional[str] = None)", "description": "Legacy flow for Jira OAuth 2.0 using client_secret without PKCE.", "scope": "", "scopeKind": ""}, {"name": "oauth_start(request: Request)", "description": "Redirects from legacy clients to the new OAuth endpoint, preserving a return URL.", "scope": "", "scopeKind": ""}, {"name": "list_routes(request: Request)", "description": "Diagnostics endpoint listing all registered routes.", "scope": "", "scopeKind": ""}, {"name": "atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] = None)", "description": "Handles OAuth callback, exchanges code for tokens, stores them, and redirects to frontend.", "scope": "", "scopeKind": ""}, {"name": "atlassian_refresh(request: Request)", "description": "Uses refresh_token to obtain a new access token and updates session.", "scope": "", "scopeKind": ""}, {"name": "list_accessible_resources(request: Request)", "description": "Fetches accessible resources from Atlassian API using stored access_token.", "scope": "", "scopeKind": ""}, {"name": "jira_callback_legacy(request: Request, code: Optional[str] = None, state: Optional[str] = None)", "description": "Legacy OAuth callback for Jira non-PKCE flow, exchanges code for tokens, then redirects.", "scope": "", "scopeKind": ""}, {"name": "get_effective_config()", "description": "Returns current configuration settings for backend URLs and redirect URIs for diagnostics.", "scope": "", "scopeKind": ""}], "calls": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "get_atlassian_oauth_config", "get_default_scopes", "get_jira_oauth_config", "get_frontend_base_url_default", "httpx.AsyncClient.post", "httpx.AsyncClient.get"], "search-terms": ["OAuth PKCE Atlassian", "Jira OAuth flow", "FastAPI OAuth routes", "session cookie management", "OAuth callback handler", "resource listing Atlassian", "refresh token Atlassian", "legacy OAuth Jira", "configuration diagnostics"], "state": 2, "file_id": 15, "knowledge_revision": 111, "git_revision": "1b779cd35659f812309db714f51620af13446bdc", "revision_history": [{"54": ""}, {"62": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"63": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"64": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"71": "c93612d2bfe887131d75d6aa4e2e91677266f41a"}, {"72": "c93612d2bfe887131d75d6aa4e2e91677266f41a"}, {"82": "e8e3b6b27369df561751d9f3714fa96ba8473925"}, {"91": "bfdff7245da8e6ccd5a638f7c0975df5e7722a10"}, {"92": "bfdff7245da8e6ccd5a638f7c0975df5e7722a10"}, {"99": "a49d74ce2b4dbb9d625dc75710bb24953cac1b24"}, {"100": "a49d74ce2b4dbb9d625dc75710bb24953cac1b24"}, {"103": "31c224f85b3a8ac8246306807a1e22e3a731efd7"}, {"104": "31c224f85b3a8ac8246306807a1e22e3a731efd7"}, {"105": "31c224f85b3a8ac8246306807a1e22e3a731efd7"}, {"107": "d230454ff52a62b345d74cd3be8a262a941138ad"}, {"108": "d230454ff52a62b345d74cd3be8a262a941138ad"}, {"109": "d230454ff52a62b345d74cd3be8a262a941138ad"}, {"111": "1b779cd35659f812309db714f51620af13446bdc"}], "ctags": [{"_type": "tag", "name": "_set_session_cookie", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^def _set_session_cookie(resp: Response, session_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(resp: Response, session_id: str)"}, {"_type": "tag", "name": "atlassian_callback", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] /", "language": "Python", "kind": "function", "signature": "(request: Request, code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "atlassian_login", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_login(request: Request, state: Optional[str] = None, scope: Optional[str] = /", "language": "Python", "kind": "function", "signature": "(request: Request, state: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "atlassian_refresh", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_refresh(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "get_effective_config", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def get_effective_config():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "jira_callback_legacy", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def jira_callback_legacy(request: Request, code: Optional[str] = None, state: Optional[str/", "language": "Python", "kind": "function", "signature": "(request: Request, code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "jira_login_alias", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def jira_login_alias(request: Request, state: Optional[str] = None, scope: Optional[str] =/", "language": "Python", "kind": "function", "signature": "(request: Request, state: Optional[str] = None, scope: Optional[str] = None, return_url: Optional[str] = None)"}, {"_type": "tag", "name": "jira_login_legacy", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def jira_login_legacy(state: Optional[str] = None, scope: Optional[str] = None):$/", "language": "Python", "kind": "function", "signature": "(state: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "list_accessible_resources", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def list_accessible_resources(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "list_routes", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def list_routes(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "oauth_start", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def oauth_start(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}], "hash": "42f6a562a7d242bc693c53874a7d14c0", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_atlassian.py", "fields": [{"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}]}