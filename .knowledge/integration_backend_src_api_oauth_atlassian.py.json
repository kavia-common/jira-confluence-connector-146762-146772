{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI routes for handling Atlassian OAuth 2.0 (3LO) with PKCE, including login initiation, callback handling, token refresh, and resource listing. It manages OAuth flow state, tokens, session cookies, and performing API calls to Atlassian endpoints.", "external_files": ["./oauth_pkce.py", "./oauth_settings.py"], "external_methods": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "get_atlassian_oauth_config", "get_default_scopes"], "published": ["router", "atlassian_login", "atlassian_callback", "atlassian_refresh", "list_accessible_resources", "get_effective_config"], "classes": [], "methods": [{"name": "None _set_session_cookie(resp: Response, session_id: str)", "description": "Sets a secure, httpOnly, SameSite lax session cookie named 'sid' with a duration of 14 days.", "scope": "", "scopeKind": ""}, {"name": "atlassian_login(request: Request, state: Optional[str] = None, scope: Optional[str] = None)", "description": "Starts the OAuth login flow by generating PKCE parameters, creating a session, and redirecting to Atlassian's authorization URL.", "scope": "", "scopeKind": ""}, {"name": "atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] = None)", "description": "Handles OAuth callback from Atlassian, validates state, exchanges code for tokens, saves tokens in session, and redirects to frontend.", "scope": "", "scopeKind": ""}, {"name": "atlassian_refresh(request: Request)", "description": "Uses stored refresh_token to obtain a new access_token and updates the session.", "scope": "", "scopeKind": ""}, {"name": "list_accessible_resources(request: Request)", "description": "Fetches and returns a list of Atlassian resources accessible with the current access token.", "scope": "", "scopeKind": ""}, {"name": "get_effective_config()", "description": "Returns current configuration environment variables for debugging.", "scope": "", "scopeKind": ""}], "calls": ["get_atlassian_oauth_config", "get_default_scopes", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "get_session", "httpx.AsyncClient", "urllib.parse.urlencode", "urllib.parse.quote_plus", "urllib.parse.unquote_plus"], "search-terms": ["OAuth", "PKCE", "Atlassian", "authorization_code", "session management", "token exchange", "resource listing", "refresh token", "FastAPI routes"], "state": 2, "file_id": 15, "knowledge_revision": 82, "git_revision": "e8e3b6b27369df561751d9f3714fa96ba8473925", "revision_history": [{"54": ""}, {"62": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"63": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"64": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"71": "c93612d2bfe887131d75d6aa4e2e91677266f41a"}, {"72": "c93612d2bfe887131d75d6aa4e2e91677266f41a"}, {"82": "e8e3b6b27369df561751d9f3714fa96ba8473925"}], "ctags": [{"_type": "tag", "name": "_set_session_cookie", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^def _set_session_cookie(resp: Response, session_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(resp: Response, session_id: str)"}, {"_type": "tag", "name": "atlassian_callback", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] /", "language": "Python", "kind": "function", "signature": "(request: Request, code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "atlassian_login", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_login(request: Request, state: Optional[str] = None, scope: Optional[str] = /", "language": "Python", "kind": "function", "signature": "(request: Request, state: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "atlassian_refresh", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_refresh(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "get_effective_config", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def get_effective_config():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_accessible_resources", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def list_accessible_resources(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}], "hash": "39567c76b3fb05b72d65e6f908efdc9b", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_atlassian.py", "fields": [{"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}]}