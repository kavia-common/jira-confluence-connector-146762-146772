{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI routes for handling OAuth 2.0 authentication with Atlassian, including login initiation, callback handling, token refresh, and resource listing. It uses PKCE for security, manages sessions via cookies, and provides diagnostic endpoints.", "external_files": ["./oauth_pkce", "./oauth_settings"], "external_methods": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "get_atlassian_oauth_config", "get_default_scopes"], "published": ["router", "oauth_start", "list_routes", "atlassian_login", "atlassian_callback", "atlassian_refresh", "list_accessible_resources", "get_effective_config"], "classes": [], "methods": [{"name": "oauth_start(request: Request)", "description": "A redirection shim that forwards to /api/oauth/atlassian/login, preserving a return_url parameter as redirect in the session state.", "scope": "", "scopeKind": ""}, {"name": "list_routes(request: StarletteRequest)", "description": "Returns a list of all registered routes for diagnostic purposes, displaying method, path, name, and tags.", "scope": "", "scopeKind": ""}, {"name": "atlassian_login(request: Request, state: Optional[str] = None, scope: Optional[str] = None)", "description": "Initiates OAuth with Atlassian using PKCE, generating a code verifier, state, and redirect URL, then redirects to Atlassian authorization endpoint.", "scope": "", "scopeKind": ""}, {"name": "atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] = None)", "description": "Handles the OAuth callback from Atlassian, exchanges authorization code for tokens, and stores tokens in session, then redirects to frontend.", "scope": "", "scopeKind": ""}, {"name": "atlassian_refresh(request: Request)", "description": "Uses the refresh token in session to obtain a new access token, updating session data.", "scope": "", "scopeKind": ""}, {"name": "list_accessible_resources(request: Request)", "description": "Uses stored access token to query Atlassian API for accessible resources (cloud IDs).", "scope": "", "scopeKind": ""}, {"name": "get_effective_config()", "description": "Returns effective configuration URLs and flags from environment variables for diagnostics.", "scope": "", "scopeKind": ""}, {"name": "None _set_session_cookie(resp: Response, session_id: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["generate_code_verifier", "generate_code_challenge", "generate_state", "get_or_create_session_id", "save_session", "get_session", "save_tokens", "get_atlassian_oauth_config", "get_default_scopes", "httpx.AsyncClient", "client.post", "client.get"], "search-terms": ["Atlassian OAuth", "PKCE", "OAuth callback", "session management", "token refresh", "accessible-resources", "OAuth start", "redirect_uri", "FastAPI OAuth routes"], "state": 2, "file_id": 15, "knowledge_revision": 92, "git_revision": "bfdff7245da8e6ccd5a638f7c0975df5e7722a10", "revision_history": [{"54": ""}, {"62": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"63": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"64": "837fa352878d17e969ace40bf39f6914f4a39086"}, {"71": "c93612d2bfe887131d75d6aa4e2e91677266f41a"}, {"72": "c93612d2bfe887131d75d6aa4e2e91677266f41a"}, {"82": "e8e3b6b27369df561751d9f3714fa96ba8473925"}, {"91": "bfdff7245da8e6ccd5a638f7c0975df5e7722a10"}, {"92": "bfdff7245da8e6ccd5a638f7c0975df5e7722a10"}], "ctags": [{"_type": "tag", "name": "StarletteRequest", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^from starlette.requests import Request as StarletteRequest$/", "language": "Python", "kind": "unknown", "nameref": "unknown:Request"}, {"_type": "tag", "name": "_set_session_cookie", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^def _set_session_cookie(resp: Response, session_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(resp: Response, session_id: str)"}, {"_type": "tag", "name": "atlassian_callback", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_callback(request: Request, code: Optional[str] = None, state: Optional[str] /", "language": "Python", "kind": "function", "signature": "(request: Request, code: Optional[str] = None, state: Optional[str] = None)"}, {"_type": "tag", "name": "atlassian_login", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_login(request: Request, state: Optional[str] = None, scope: Optional[str] = /", "language": "Python", "kind": "function", "signature": "(request: Request, state: Optional[str] = None, scope: Optional[str] = None)"}, {"_type": "tag", "name": "atlassian_refresh", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def atlassian_refresh(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "get_effective_config", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def get_effective_config():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_accessible_resources", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def list_accessible_resources(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "list_routes", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def list_routes(request: StarletteRequest):$/", "language": "Python", "kind": "function", "signature": "(request: StarletteRequest)"}, {"_type": "tag", "name": "oauth_start", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^async def oauth_start(request: Request):$/", "language": "Python", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/jira-confluence-connector-146762-146772/integration_backend/src/api/oauth_atlassian.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}], "hash": "843863e9e9bc48f2771393c44919eead", "format-version": 4, "code-base-name": "integration_backend", "filename": "integration_backend/src/api/oauth_atlassian.py", "fields": [{"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}]}